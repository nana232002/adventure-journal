(function(d){var b=window.AmazonUIPageJS||window.P,h=b._namespace||b.attributeErrors,e=h?h("StarlingInterestGroupAssignment",""):b;e.guardFatal?e.guardFatal(d)(e,window):e.execute(function(){d(e,window)})})(function(d,b,h){d.now("StarlingIGConfiguration").execute(function(b){b||d.register("StarlingIGConfiguration",function(){function a(){return navigator.userAgent}var b=/chrome|chromium|crios/i,c=/opr\//i,g=/edg/i;return{getRoboticSessionId:function(){return"000-0000000-0000000"},getToken:function(a){switch(a){case "gamma":return"A+qAAwo/s1iDqc/hfoGSql86NR2wqWsxKIUj8+Zl/KP9ErZQwRM3HhdY1Q39N1bAueSVZZ+92xFH69iddkTxZwEAAACJeyJvcmlnaW4iOiJodHRwczovL3ByZS1wcm9kLmFtYXpvbi5jb206NDQzIiwiZmVhdHVyZSI6IlByaXZhY3lTYW5kYm94QWRzQVBJcyIsImV4cGlyeSI6MTY5NTE2Nzk5OSwiaXNTdWJkb21haW4iOnRydWUsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0\x3d";
case "prod":return"A69tl2WjpmRBbEqXW1MOXcXGrvFyLn/bow90s5sv6cViJ1eGQCytat/+fYLyCa0i/5O88qtcfMU9MMRZH5RSPAcAAACEeyJvcmlnaW4iOiJodHRwczovL3d3dy5hbWF6b24uY29tOjQ0MyIsImZlYXR1cmUiOiJQcml2YWN5U2FuZGJveEFkc0FQSXMiLCJleHBpcnkiOjE2OTUxNjc5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"}},generateGatewayUrl:function(a){switch(a){case "beta":return"https://at-"+a+".amazon-adsystem.com";case "gamma":return"https://at-"+a+"-us-east.amazon-adsystem.com";case "prod":return"https://at-us-east.amazon-adsystem.com"}},
isChrome:function(){var k=a(),f=!1;k&&(k.match(b)&&(f=!0),k.match(c)?f=!1:k.match(g)&&(f=!1));return f},getUserAgent:a,getApnPrivacySetting:function(){if(null!==document&&null!==document.cookie){var a=document.cookie.match(/(^| )apn-privacy=([^;]+)/);if(a)return"true"===a[2]}return!1},provideToken:function(a){if(null!==document&&null!==document.head){var c=document.createElement("meta");c.httpEquiv="origin-trial";c.content=a;document.head.appendChild(c)}}}})});"use strict";d.now("StarlingAddMetric").execute(function(e){e||
d.register("StarlingAddMetric",function(){return{addMetric:function(a,f){b.ue&&b.ue.count&&b.ue.count(a,f)}}})});"use strict";d.now("StarlingLogError").execute(function(e){e||d.register("StarlingLogError",function(){return{logError:function(a){var f={logLevel:2<arguments.length&&arguments[2]!==h?arguments[2]:"ERROR",attribution:"StarlingInterestGroupAssignment",message:1<arguments.length&&arguments[1]!==h?arguments[1]:""};b.ueLogError&&b.ueLogError(a,f);return[a,f]}}})});"use strict";d.now("StarlingIGJoinHelpers").execute(function(b){b||
d.when("StarlingIGHelpers","StarlingIGConfiguration","StarlingAddMetric","StarlingLogError","StarlingUtils").register("StarlingIGJoinHelpers",function(a,b,c,g,d){function f(a){var b=0,f=0,e=[];a.forEach(function(a){e.push(new Promise(function(c,b){try{d.getNavigator().joinAdInterestGroup(a,30*d.SECONDS_PER_DAY),c(a)}catch(p){b(p)}}))});return Promise.allSettled(e).then(function(a){a.forEach(function(a){"fulfilled"===a.status?b+=1:f+=1});c.addMetric("Starling:BrowserAddedToIG:True",b);c.addMetric("Starling:BrowserAddedToIG:False",
f);d.getCustomerId()?c.addMetric("Starling:IGAssigned:AmazonCustomer",b):c.addMetric("Starling:IGAssigned:AmazonGuest",b)}).catch(function(a){c.addMetric("Starling:PromiseResolverError",1);g.logError(a,"Starling:PromiseResolveError. Error resolving IGJoinPromiseArray.")})}return{browserSupportsAdInterestGroup:function(){return"joinAdInterestGroup"in navigator&&document.featurePolicy.allowsFeature("join-ad-interest-group")&&document.featurePolicy.allowsFeature("run-ad-auction")},joinAdInterestGroupsV2:function(d,
e){e=b.generateGatewayUrl(e);return a.listInterestGroups(e+"/interestGroups/v2/join/",d).then(function(a){c.addMetric("Starling:ReceivedGatewayJoinV2Response",1);return a.json()}).then(function(c){c=a.parseIGMetadataFromResponse(c);return f(c)}).catch(function(a){a instanceof TypeError?(c.addMetric("Starling:FailedToFetchJoinV2Error",1),g.logError(a,"Starling:FailedToFetchJoinV2Error. Error making fetch request.")):(c.addMetric("Starling:ParseGatewayJoinV2ResponseError",1),g.logError(a,"Starling:ParseGatewayJoinV2ResponseError. Error parsing IG Metadata from Gateway."))})}}})});
"use strict";d.now("StarlingInterestGroupAssign").execute(function(b){b||(d.register("StarlingInterestGroupAssign",function(){var a={init:function(b,c,g,d,e){a.config=b;a.joinHelpers=d;a.metrics=c;a.errors=g;a.utils=e;b=a.config.getRoboticSessionId();c=a.utils.getHref();a.config.isChrome()&&(c?(c=a.utils.getStage(c),g=a.config.getToken(c),a.config.provideToken(g),a.assignIG(c,b)):(a.metrics.addMetric("Starling:PageLoadError",1),a.errors.logError({message:"Starling:PageLoadError. Error retreiving url from window."})))},
assignIG:function(b,c){if(a.joinHelpers.browserSupportsAdInterestGroup()){a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:True",1);var d=a.utils.lookupLocalStorage("csm:adb");if(null!=d&&d.endsWith("yes"))a.metrics.addMetric("Starling:AdBlockEnabled:True",1);else{a.metrics.addMetric("Starling:AdBlockEnabled:False",1);d=a.utils.getSessionId();var e=a.utils.getCustomerId(),f=a.utils.getPageType(),h=a.utils.getASIN(),l=a.config.getApnPrivacySetting(),m=a.utils.getHref();c=d===c;var n=a.utils.getRandomUUID();
l||c?a.metrics.addMetric("Starling:TotalPunts",1):a.joinHelpers.joinAdInterestGroupsV2({requestId:n,identity:{customerId:e,sessionId:d},pageInformation:{pageURL:m,pageType:f,asins:[h]},marketplaceId:"1"},b);l&&a.metrics.addMetric("Starling:UserOptedOut:True",1);c&&a.metrics.addMetric("Starling:RoboticTraffic:True",1);e?a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:AmazonCustomer",1):d?a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:AmazonGuest",1):a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:NoCustomerOrSessionId")}}else a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:False",
1)}};return a}),d.when("StarlingIGConfiguration","StarlingAddMetric","StarlingLogError","StarlingIGJoinHelpers","StarlingInterestGroupAssign","StarlingUtils","ready").execute(function(a,b,c,d,e,h){e.init(a,b,c,d,h)}))});"use strict";d.now("StarlingUtils").execute(function(e){e||d.register("StarlingUtils",function(){var a=/development|beta/,d=/pre-prod|gamma/;return{lookupLocalStorage:function(a){try{return b.localStorage.getItem(a)}catch(g){return null}},addToLocalStorage:function(a,d){try{a=String(a),
d=String(d),b.localStorage.setItem(a,d)}catch(k){}},removeFromLocalStorage:function(a){try{b.localStorage.getItem(a)!==h&&b.localStorage.removeItem(a)}catch(g){}},getHref:function(){return b.location.href},getWindowOpts:function(){return b.opts},getCustomerId:function(){if(b.fwcimData)return b.fwcimData.customerId;if(b.opts)return b.opts.customerId},getStage:function(b){return a.test(b)?"beta":d.test(b)?"gamma":"prod"},getNavigator:function(){return navigator},getSessionId:function(){if(b.ue)return b.ue.sid;
if(b.opts)return b.opts.sessionId},getPageType:function(){return b.ue_pty},getASIN:function(){return b.ue_pti},getRandomUUID:function(){return"undefined"!==typeof crypto&&crypto.randomUUID?crypto.randomUUID():"requestId"},SECONDS_PER_DAY:86400}})});"use strict";d.now("StarlingIGHelpers").execute(function(b){b||d.when("StarlingAddMetric","StarlingLogError").register("StarlingIGHelpers",function(a,b){return{parseIGMetadataFromResponse:function(c){if(c){if((c=c.interestGroups)&&Array.isArray(c))return 0<
c.length?a.addMetric("Starling:AttemptedIGAdd",c.length):a.addMetric("Starling:GatewayNoIGsReturned",1),c;a.addMetric("Starling:GatewayReturnedIGMetadata:False",1);b.logError({message:"Starling:GatewayReturnedIGMetadata:False. IG Metadata from Gateway is incorrect format."});return null}a.addMetric("Starling:NullGatewayResponseError",1);b.logError({message:"Starling:NullGatewayResponseError. Null IGMetadata response from Gateway."});return null},listInterestGroups:function(a,b){return fetch(a,{method:"PUT",
body:JSON.stringify(b),credentials:"include"})}}})})});